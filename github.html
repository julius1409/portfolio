<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GitHub Ongoing | Julius</title>

    <link
      href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@400;700&display=swap"
      rel="stylesheet"
    />

    <style>
      :root {
        --bg: #ffffff;
        --fg: #0b0b0b;
        --muted: rgba(11, 11, 11, 0.66);
        --muted2: rgba(11, 11, 11, 0.5);

        --shadow: 0 18px 60px rgba(0, 0, 0, 0.08);
        --shadow2: 0 10px 30px rgba(0, 0, 0, 0.06);

        --radius: 18px;
        --max: 980px;

        --line: rgba(0, 0, 0, 0.08);
        --soft: rgba(0, 0, 0, 0.03);

        /* subtle NATO-olive (transparent) */
        --olive: rgba(107, 122, 96, 0.14);
        --oliveLine: rgba(107, 122, 96, 0.28);

        --padX: 18px;
      }

      * { box-sizing: border-box; }
      html { scroll-behavior: smooth; }
      body {
        margin: 0;
        background: var(--bg);
        color: var(--fg);
        font-family: "Inconsolata", monospace;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      .container {
        max-width: var(--max);
        margin: 0 auto;
        padding: 22px var(--padX) 96px;
      }

      /* topbar */
      .topbar {
        position: sticky;
        top: 12px;
        z-index: 30;
        display: flex;
        justify-content: center;
        margin: 12px 0 18px;
        padding: 0 var(--padX);
      }
      .topbar-inner {
        width: 100%;
        max-width: var(--max);
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
        padding: 9px 12px;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.84);
        backdrop-filter: blur(12px);
        box-shadow: var(--shadow2);
      }
      .brand {
        text-decoration: none;
        color: var(--muted);
        font-size: 0.9rem;
        white-space: nowrap;
      }
      .nav {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        justify-content: flex-end;
      }
      .pill {
        text-decoration: none;
        color: var(--fg);
        font-size: 0.9rem;
        padding: 7px 10px;
        border-radius: 999px;
        background: rgba(0, 0, 0, 0.04);
        transition: transform 160ms ease, background 160ms ease;
      }
      .pill:hover {
        transform: translateY(-1px);
        background: rgba(0, 0, 0, 0.06);
      }

      header {
        margin-top: 26px;
        text-align: center;
      }
      .kicker {
        margin: 0;
        color: var(--muted);
        letter-spacing: 0.14em;
        text-transform: uppercase;
        font-size: 0.92rem;
      }
      h1 {
        margin: 14px 0 0;
        font-size: clamp(2rem, 3.2vw + 1rem, 3rem);
        letter-spacing: -0.02em;
      }
      .lead {
        margin: 18px auto 0;
        max-width: 82ch;
        color: var(--muted);
        line-height: 1.95;
        font-size: 1.03rem;
      }

      .stack { margin-top: 44px; }
      .grid {
        margin-top: 28px;
        display: grid;
        gap: 18px;
        grid-template-columns: 1fr;
      }
      @media (min-width: 900px) {
        .grid { grid-template-columns: 1.35fr 0.65fr; }
      }

      .cards {
        margin-top: 40px;
        display: grid;
        gap: 18px;
        grid-template-columns: 1fr;
      }
      @media (min-width: 900px) {
        .cards { grid-template-columns: repeat(2, 1fr); }
      }

      .tile {
        border-radius: var(--radius);
        background: #fff;
        box-shadow: var(--shadow);
        overflow: hidden;
      }
      .tile.olive {
        background: linear-gradient(180deg, var(--olive), rgba(255,255,255,0.92));
        outline: 1px solid var(--oliveLine);
        outline-offset: -1px;
      }

      .tile-head { padding: 18px 18px 14px; text-align: center; }
      .tile-title {
        margin: 0;
        font-size: 1.05rem;
        letter-spacing: 0.12em;
        text-transform: uppercase;
      }
      .tile-sub {
        margin: 10px 0 0;
        color: var(--muted);
        line-height: 1.75;
        max-width: 78ch;
        margin-left: auto;
        margin-right: auto;
      }
      .rule { height: 1px; background: var(--line); margin: 0 18px 18px; }
      .tile-body { padding: 0 18px 18px; }

      .row {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        align-items: center;
        justify-content: center;
      }

      .btn {
        appearance: none;
        border: 0;
        background: rgba(0, 0, 0, 0.04);
        color: var(--fg);
        border-radius: 999px;
        padding: 10px 14px;
        font-family: inherit;
        font-size: 0.95rem;
        cursor: pointer;
        transition: transform 160ms ease, background 160ms ease;
      }
      .btn:hover { transform: translateY(-1px); background: rgba(0, 0, 0, 0.06); }
      .btn:active { transform: translateY(0); }
      .btn.ghost { background: transparent; outline: 1px solid var(--line); }
      .btn.ghost:hover { background: rgba(0,0,0,0.03); }

      .pillbox {
        display: inline-flex;
        gap: 10px;
        align-items: center;
        border-radius: 999px;
        background: rgba(0,0,0,0.03);
        padding: 10px 12px;
        color: var(--muted2);
      }

      .range { width: min(640px, 100%); }

      .poem {
        margin-top: 18px;
        border-radius: calc(var(--radius) - 4px);
        background: rgba(0, 0, 0, 0.03);
        padding: 18px;
        box-shadow: var(--shadow2);
        text-align: center;
      }
      .poem-meta {
        display: flex;
        justify-content: space-between;
        gap: 12px;
        flex-wrap: wrap;
        color: var(--muted2);
        font-size: 0.92rem;
        margin-bottom: 12px;
      }
      .poem-text {
        margin: 0;
        white-space: pre-wrap;
        line-height: 1.95;
        font-size: 1.02rem;
        text-align: center;
      }

      /* compact dot window so it stays elegant even with many stanzas */
      .dots {
        margin-top: 14px;
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        gap: 6px;
      }
      .dot {
        width: 8px;
        height: 8px;
        border-radius: 999px;
        background: rgba(0,0,0,0.18);
        opacity: 0.55;
      }
      .dot.on { background: rgba(0,0,0,0.82); opacity: 1; }

      .note {
        border-radius: var(--radius);
        background: rgba(0, 0, 0, 0.03);
        padding: 16px;
        box-shadow: var(--shadow2);
        text-align: center;
      }
      .note h3 { margin: 0; font-size: 1.02rem; }
      .note p { margin: 12px 0 0; color: var(--muted); line-height: 1.85; }

      .losung {
        border-radius: calc(var(--radius) - 4px);
        background: rgba(0, 0, 0, 0.03);
        padding: 18px;
        box-shadow: var(--shadow2);
        text-align: center;
      }
      .losung .date { color: var(--muted2); font-size: 0.92rem; margin: 0 0 12px; }
      .losung .label {
        letter-spacing: 0.12em;
        text-transform: uppercase;
        font-size: 0.9rem;
        color: var(--muted2);
        margin: 0;
      }
      .losung .verse { margin: 10px 0 0; line-height: 1.9; font-size: 1.02rem; }
      .losung .ref { margin: 8px 0 0; color: var(--muted); font-size: 0.95rem; }

      footer {
        margin-top: 70px;
        text-align: center;
        color: rgba(11, 11, 11, 0.55);
        font-size: 0.92rem;
      }

      @media (prefers-reduced-motion: reduce) {
        html { scroll-behavior: auto; }
        .pill, .btn { transition: none; }
      }
    </style>
  </head>

  <body>
    <div class="topbar">
      <div class="topbar-inner">
        <a class="brand" href="index.html">Julius</a>
        <nav class="nav">
          <a class="pill" href="index.html#projects">Back to Projects</a>
        </nav>
      </div>
    </div>

    <main class="container">
      <header>
        <p class="kicker">Project</p>
        <h1>GitHub Ongoing</h1>
        <p class="lead">
          Clean UI, real modules. A poem engine that looks like a product tile, plus a daily watchword tile.
        </p>
      </header>

      <section class="grid stack">
        <article class="tile" id="poemTile">
          <div class="tile-head">
            <h2 class="tile-title">Die Glocke</h2>
            <p class="tile-sub">
              Full text loaded from assets, split into stanzas by blank lines. Slider, random, copy.
            </p>
          </div>

          <div class="rule"></div>

          <div class="tile-body">
            <div class="row" style="margin-bottom: 14px;">
              <button class="btn" id="prevBtn" type="button">Prev</button>
              <button class="btn" id="randomBtn" type="button">Random</button>
              <button class="btn" id="nextBtn" type="button">Next</button>
              <button class="btn ghost" id="copyBtn" type="button">Copy stanza</button>
            </div>

            <div class="row" style="margin-bottom: 14px;">
              <div class="pillbox"><span id="stanzaLabel">Loading ...</span></div>
              <input class="range" id="stanzaRange" type="range" min="0" max="0" value="0" />
            </div>

            <div class="poem" role="region" aria-label="Poem stanza">
              <div class="poem-meta">
                <span id="poemCount">Loading ...</span>
                <span id="poemHint">Split rule: blank line = new stanza</span>
              </div>
              <p class="poem-text" id="poemText"></p>
              <div class="dots" id="dots" aria-hidden="true"></div>
            </div>
          </div>
        </article>

        <aside class="tile">
          <div class="tile-head">
            <h2 class="tile-title">Design Notes</h2>
            <p class="tile-sub">
              Bigger spacing, centered layout, and quiet shadow language. Minimal, but not empty.
            </p>
          </div>
          <div class="rule"></div>
          <div class="tile-body">
            <div class="note">
              <h3>Spacing</h3>
              <p>More air between blocks, less visual noise, faster scanning.</p>
            </div>
            <div style="height: 14px;"></div>
            <div class="note">
              <h3>Interaction</h3>
              <p>Only the controls you need: prev, next, random, copy.</p>
            </div>
            <div style="height: 14px;"></div>
            <div class="note">
              <h3>Implementation</h3>
              <p>Poem stays in a text file, UI stays clean, stanzas are automatic.</p>
            </div>
          </div>
        </aside>
      </section>

      <section class="cards stack">
        <article class="tile olive">
          <div class="tile-head">
            <h2 class="tile-title">Gold Desk</h2>
            <p class="tile-sub">
              Leave this tile as is or remove it. Not touched in this revision.
            </p>
          </div>
          <div class="rule"></div>
          <div class="tile-body">
            <div class="note">
              <h3>Optional</h3>
              <p>
                Keep your gold widgets from your previous version here. This change request was poem and watchword only.
              </p>
            </div>
          </div>
        </article>

        <article class="tile">
          <div class="tile-head">
            <h2 class="tile-title">Tageslosung</h2>
            <p class="tile-sub">
              Loaded from losungen.app API. If it fails, you see a calm fallback message.
            </p>
          </div>

          <div class="rule"></div>

          <div class="tile-body">
            <div class="row" style="margin-bottom: 14px;">
              <button class="btn" type="button" id="losungRefresh">Refresh</button>
            </div>

            <div class="losung" id="losungBox" aria-live="polite">
              <p class="date" id="losungDate">Loading ...</p>

              <div style="margin-top: 10px;">
                <p class="label">Losung</p>
                <p class="verse" id="losungText">—</p>
                <p class="ref" id="losungRef"></p>
              </div>

              <div style="margin-top: 18px;">
                <p class="label">Lehrtext</p>
                <p class="verse" id="lehrText">—</p>
                <p class="ref" id="lehrRef"></p>
              </div>
            </div>
          </div>
        </article>
      </section>

      <footer>It is a portfolio. It is also a lab.</footer>
    </main>

    <script>
      // -----------------------------
      // Poem engine: load from assets and split into stanzas
      // Rule: one or more blank lines = new stanza
      // -----------------------------
      (function () {
        const range = document.getElementById("stanzaRange");
        const text = document.getElementById("poemText");
        const label = document.getElementById("stanzaLabel");
        const countEl = document.getElementById("poemCount");
        const dotsEl = document.getElementById("dots");

        const prevBtn = document.getElementById("prevBtn");
        const nextBtn = document.getElementById("nextBtn");
        const randomBtn = document.getElementById("randomBtn");
        const copyBtn = document.getElementById("copyBtn");

        const STOR_KEY = "github_glocke_stanza_v2";
        let stanzas = [];
        let idx = 0;

        function clamp(n, a, b) { return Math.max(a, Math.min(b, n)); }

        function buildDotsWindow() {
          dotsEl.innerHTML = "";
          const total = stanzas.length;
          if (!total) return;

          const windowSize = 15;
          const half = Math.floor(windowSize / 2);
          const start = clamp(idx - half, 0, Math.max(0, total - windowSize));
          const end = Math.min(total, start + windowSize);

          for (let i = start; i < end; i++) {
            const d = document.createElement("span");
            d.className = "dot" + (i === idx ? " on" : "");
            dotsEl.appendChild(d);
          }
        }

        function render() {
          if (!stanzas.length) {
            label.textContent = "No stanzas loaded";
            countEl.textContent = "0 stanzas";
            text.textContent = "";
            return;
          }
          label.textContent = `Stanza ${idx + 1} of ${stanzas.length}`;
          countEl.textContent = `${stanzas.length} stanzas`;
          range.value = String(idx);
          text.textContent = stanzas[idx];
          buildDotsWindow();
          localStorage.setItem(STOR_KEY, String(idx));
        }

        function setIndex(n) {
          idx = clamp(n, 0, stanzas.length - 1);
          render();
        }

        async function loadPoem() {
          try {
            const res = await fetch("assets/die-glocke.txt", { cache: "no-store" });
            if (!res.ok) throw new Error("poem file missing");
            const raw = (await res.text()).replace(/\r\n/g, "\n").trim();

            // split by blank lines
            stanzas = raw
              .split(/\n{2,}/g)
              .map((s) => s.trim())
              .filter(Boolean);

            range.min = "0";
            range.max = String(Math.max(0, stanzas.length - 1));
            range.step = "1";

            const saved = Number(localStorage.getItem(STOR_KEY));
            if (!Number.isNaN(saved)) idx = clamp(saved, 0, stanzas.length - 1);

            render();
          } catch (e) {
            label.textContent = "Poem not loaded";
            countEl.textContent = "Check assets/die-glocke.txt";
            text.textContent =
              "Create assets/die-glocke.txt and paste the full poem. Separate stanzas with one blank line.";
          }
        }

        range.addEventListener("input", () => setIndex(Number(range.value)));
        prevBtn.addEventListener("click", () => setIndex(idx - 1));
        nextBtn.addEventListener("click", () => setIndex(idx + 1));
        randomBtn.addEventListener("click", () => {
          if (stanzas.length <= 1) return;
          let n = idx;
          while (n === idx) n = Math.floor(Math.random() * stanzas.length);
          setIndex(n);
        });
        copyBtn.addEventListener("click", async () => {
          if (!stanzas.length) return;
          try {
            await navigator.clipboard.writeText(stanzas[idx]);
          } catch {}
        });

        loadPoem();
      })();

      // -----------------------------
      // Tageslosung: correct endpoint
      // -----------------------------
      (function () {
        const dateEl = document.getElementById("losungDate");
        const losungTextEl = document.getElementById("losungText");
        const losungRefEl = document.getElementById("losungRef");
        const lehrTextEl = document.getElementById("lehrText");
        const lehrRefEl = document.getElementById("lehrRef");
        const btn = document.getElementById("losungRefresh");

        function pick(obj, keys) {
          for (const k of keys) {
            if (obj && obj[k] != null && String(obj[k]).trim() !== "") return obj[k];
          }
          return "";
        }

        async function load() {
          dateEl.textContent = "Loading ...";
          losungTextEl.textContent = "—";
          lehrTextEl.textContent = "—";
          losungRefEl.textContent = "";
          lehrRefEl.textContent = "";

          try {
            const url = "https://api.losungen.app/v1/watchword/german/today.json";
            const res = await fetch(url, { cache: "no-store" });
            if (!res.ok) throw new Error("bad response");
            const data = await res.json();

            const date = pick(data, ["Datum", "datum", "date"]);
            const losText = pick(data, ["Losungstext", "losungstext", "LosungText"]);
            const losRef = pick(data, ["Losungsvers", "losungsvers", "LosungVers"]);
            const lehText = pick(data, ["Lehrtext", "lehrtext", "LehrText"]);
            const lehRef = pick(data, ["Lehrtextvers", "lehrtextvers", "Lehrvers", "lehrvers"]);

            dateEl.textContent = date ? String(date) : "Today";
            losungTextEl.textContent = losText ? String(losText) : "No data";
            losungRefEl.textContent = losRef ? String(losRef) : "";
            lehrTextEl.textContent = lehText ? String(lehText) : "No data";
            lehrRefEl.textContent = lehRef ? String(lehRef) : "";
          } catch (e) {
            dateEl.textContent = "Could not load (check connection)";
            losungTextEl.textContent = "API endpoint failed.";
            lehrTextEl.textContent = "Try again with Refresh.";
          }
        }

        btn.addEventListener("click", load);
        load();
      })();
    </script>
  </body>
</html>
